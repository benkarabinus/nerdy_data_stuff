knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(HistData)
data("Guerry")
dat<-Guerry
dat.c<-filter(dat,Region=="C")
(g<-ggplot(data=dat.c,aes(x=Commerce,y=Wealth))+geom_point())
w<-dat.c$Wealth
c<-dat.c$Commerce
n<-nrow(dat.c)
(m<-(sum(c*w)/n-mean(c)*mean(w))/
(sum((c)^2)/n-mean(c)^2))
(b<-mean(w)-m*mean(c))
(g+geom_abline(slope=m, intercept=b))
setwd("~/OneDrive - University of Denver/COMP4442/ProblemSetsWorkingDirectory/Week2")
# load required libraries
library(ggplot2)
library(ggpubr)
library(car)
library(dplyr)
library(ggeasy)
doughnuts.factorial <- read.csv("doughnutsfactorial.csv", header=TRUE, sep=",") # Loads the CSV file into memory. You may need to adapt this line to work on your computer
# create factors for flour_type and fat_type
doughnuts.factorial$fat_type_factor <- as.factor(doughnuts.factorial$fat_type)
doughnuts.factorial$flour_type_factor <-
as.factor(doughnuts.factorial$flour_type)
#check the structure of the dataset
str(doughnuts.factorial)
# Create ggqqplot for flour_type, fat_type combinations
donut_plt <- ggqqplot(doughnuts.factorial, x="sim_tot_fat",
facet.by =c("fat_type_factor","flour_type_factor"))
donut_plt
# Run the Shapiro-Wilk test for each fat_type, flour_type combination and display as tibble
sw_doughnuts.factorial <- doughnuts.factorial %>%
group_by(fat_type_factor,
flour_type_factor)%>%
summarize(pval=shapiro.test(sim_tot_fat)$p)
sw_doughnuts.factorial
# create ggplot geom_boxplot to assess variance of groups visually
donut_box_plt <-ggplot(doughnuts.factorial,
aes(x=fat_type_factor, y=sim_tot_fat,
fill=flour_type_factor))+
geom_boxplot()
ggplot(data=doughnuts.factorial, aes(y=sim_tot_fat))+
geom_boxplot()+facet_grid(rows=vars(flour_type_factor),
cols=vars(fat_type_factor))+
ggtitle("Mean Fat Absorption by Fat Type & Flour Type")+
ggeasy::easy_center_title()
donut_box_plt
# perform the Brown-Forsythe aka Levene test
leveneTest(sim_tot_fat~fat_type_factor*flour_type_factor,
data = doughnuts.factorial)
# one-way ANOVa sim_tot_fat~fat_type_factor
fat.aov <- aov(sim_tot_fat~fat_type_factor,
data=doughnuts.factorial)
# ANOVA summary
summary(fat.aov)
# one-way ANOVa flour_type_factor
flour.aov <- aov(sim_tot_fat~flour_type_factor, data=doughnuts.factorial)
# ANOVA summary
summary(flour.aov)
# create two-way ANOVA with interaction term
fat_flour_int.aov<-aov(sim_tot_fat~fat_type_factor*flour_type_factor,
data=doughnuts.factorial)
# ANOVA Summary
summary(fat_flour_int.aov)
View(doughnuts.factorial)
