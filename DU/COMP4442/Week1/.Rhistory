knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(HistData)
data("Guerry")
dat<-Guerry
dat.c<-filter(dat,Region=="C")
(g<-ggplot(data=dat.c,aes(x=Commerce,y=Wealth))+geom_point())
w<-dat.c$Wealth
c<-dat.c$Commerce
n<-nrow(dat.c)
(m<-(sum(c*w)/n-mean(c)*mean(w))/
(sum((c)^2)/n-mean(c)^2))
(b<-mean(w)-m*mean(c))
(g+geom_abline(slope=m, intercept=b))
setwd("~/OneDrive - University of Denver/COMP4442/ProblemSetsWorkingDirectory/Week1")
# load required packages
library(ggplot2)
library(ggpubr)
library(dplyr)
library(ggeasy)
library(lawstat)
# Loads the CSV file into memory. You may need to adapt this line to work on your computer
doughnuts <- read.csv("doughnuts.csv",header=TRUE,sep=",")
# Creates a new variable and tells R that the values are categorical ("factor")
doughnuts$fat_type_factor <- as.factor(doughnuts$fat_type)
# View dataset attributes
str(doughnuts)
# Function to calculate sample standard deviation(built-in sd is alternative)
std_samp <- function(data){
sqrt(sum((data-mean(data))^2/(length(data)-1)))
}
# compute sample mean and standard deviation for each fat type as tibble using dplyr
fat_type_mean_sd <- doughnuts %>%
group_by(fat_type_factor) %>%
summarise_at(vars(total_fat),
list(mean=mean, standard_deviation=std_samp))
fat_type_mean_sd
# create bar plot using ggplot2 - geom_bar()
d_plt <- ggplot(fat_type_mean_sd)+
geom_bar(aes(x=fat_type_factor, y=mean),
stat ="identity",fill=c("red","green", "blue", "orange"))+
xlab("Fat types")+
ylab("Mean fat absorbed (grams)")+
ggtitle("Mean Fat Absorption by Type")+
geom_errorbar(aes(x=fat_type_factor, ymin=mean-standard_deviation,
ymax=mean+standard_deviation),width=0.4)+
ggeasy::easy_center_title()
d_plt
# use ggqqplot to assess the assumption of normality for data by factor level
ggqqplot(doughnuts, x="total_fat", facet.by = "fat_type_factor")
# use the Shapiro-Wilk test with dplyr to assess normality and display as tibble
sw_doughnuts <- doughnuts %>%
group_by(fat_type_factor)%>%
summarize(pval=shapiro.test(total_fat)$p)
sw_doughnuts
# create ggplot geom_boxplot to assess variance between groups visually
ggplot(doughnuts, aes(x=fat_type_factor, y=total_fat))+
geom_boxplot()
# conduct the Brown-Forsythe test
levene.test(doughnuts$total_fat, doughnuts$fat_type_factor)
#conduct the one-way anova
doughnuts.aov <- aov(total_fat~fat_type_factor, data=doughnuts)
#display summary of results
summary(doughnuts.aov)
# use the TukeyHSD function to perform analysis
TukeyHSD(doughnuts.aov, conf.level = .95)
